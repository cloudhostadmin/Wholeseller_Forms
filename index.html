<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡§ó‡•Ä‡§§‡§æ ‡§™‡•ç‡§∞‡•á‡§∏ ‡§µ‡§ø‡§ï‡•ç‡§∞‡•á‡§§‡§æ ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§´‡•â‡§∞‡•ç‡§Æ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); padding: 20px; line-height: 1.5; }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 40px; border-radius: 10px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); width: 100%; }
        .header { text-align: center; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 3px solid #ff6b35; }
        .header h1 { color: #d35400; font-size: 28px; margin-bottom: 8px; }
        .header h2 { color: #555; font-size: 18px; font-weight: normal; margin-bottom: 5px; }
        .header p { color: #666; font-size: 13px; margin-top: 5px; }
        .date-tally { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 25px; }
        .section { margin-bottom: 25px; page-break-inside: avoid; }
        .section-title { background: #ff6b35; color: white; padding: 10px 18px; margin-bottom: 15px; border-radius: 5px; font-size: 16px; font-weight: bold; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 6px; color: #333; font-weight: 600; font-size: 13px; }
        input[type="text"], input[type="email"], input[type="tel"], input[type="date"], input[type="number"], textarea { width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 5px; font-size: 13px; transition: border-color 0.3s; box-sizing: border-box; font-family: inherit; }
        input:focus, textarea:focus { outline: none; border-color: #ff6b35; }
        textarea { min-height: 65px; resize: vertical; }
        .row { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
        .checkbox-group { display: flex; gap: 15px; flex-wrap: wrap; margin-top: 8px; }
        .checkbox-group label { display: flex; align-items: center; font-weight: normal; margin-bottom: 0; }
        .checkbox-group input[type="checkbox"], .checkbox-group input[type="radio"] { width: auto; margin-right: 6px; }
        .declaration { background: #fff3cd; padding: 15px; border-radius: 5px; border-left: 4px solid #ffc107; page-break-inside: avoid; margin-bottom: 20px; }
        .declaration h3 { color: #856404; margin-bottom: 10px; font-size: 14px; }
        .declaration p { margin-bottom: 10px; font-size: 12px; }
        .declaration ol { margin-left: 20px; font-size: 12px; line-height: 1.4; }
        .declaration li { margin-bottom: 6px; color: #333; }
        .signature-section { margin-top: 20px; padding-top: 15px; border-top: 2px solid #ddd; page-break-inside: avoid; }
        .signature-row { display: grid; grid-template-columns: 1fr; gap: 15px; margin-top: 15px; }
        .submit-btn { background: #ff6b35; color: white; padding: 14px 35px; border: none; border-radius: 5px; font-size: 16px; font-weight: bold; cursor: pointer; width: 100%; margin-top: 20px; transition: background 0.3s; }
        .submit-btn:hover { background: #d35400; }
        .submit-btn:disabled { background: #ccc; cursor: not-allowed; }
        .note { color: #666; font-size: 11px; font-style: italic; }
        .status-msg { display: none; font-size: 12px; margin-top: 4px; }
        .loading { color: #673ab7; }
        .error { color: #d93025; }
        .success { color: #1e8e3e; }
        .submit-status { margin-top: 10px; padding: 10px; border-radius: 5px; display: none; }
        .post-submit-actions { display: none; margin-top: 20px; padding: 20px; background: #e8f5e9; border-radius: 5px; text-align: center; }
        .post-submit-actions h3 { font-size: 16px; margin-bottom: 8px; }
        .post-submit-actions p { font-size: 13px; margin-bottom: 12px; }
        .post-submit-actions button { margin: 8px; padding: 10px 20px; background: #4caf50; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 13px; }
        .post-submit-actions button:hover { background: #45a049; }
        .whatsapp-btn { background: #25d366 !important; }
        .whatsapp-btn:hover { background: #128c7e !important; }
        .pdf-generating { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 10px; box-shadow: 0 10px 40px rgba(0,0,0,0.3); z-index: 10000; text-align: center; display: none; }
        .pdf-generating.show { display: block; }
        .pdf-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999; display: none; }
        .pdf-overlay.show { display: block; }

        /* OPTIMIZED PDF MODE - FITS IN 1-2 PAGES */
        .pdf-mode { padding: 8mm !important; max-width: 100% !important; box-shadow: none !important; }
        .pdf-mode .submit-btn, .pdf-mode .post-submit-actions, .pdf-mode .status-msg { display: none !important; }
        .pdf-mode input, .pdf-mode textarea { border: 0.5px solid #333 !important; background: white !important; font-size: 8pt !important; padding: 4px !important; }
        .pdf-mode .section { margin-bottom: 10px !important; page-break-inside: avoid !important; }
        .pdf-mode .section-title { font-size: 9.5pt !important; padding: 6px 12px !important; margin-bottom: 8px !important; }
        .pdf-mode .header { margin-bottom: 10px !important; padding-bottom: 8px !important; }
        .pdf-mode .header h1 { font-size: 14pt !important; margin-bottom: 3px !important; }
        .pdf-mode .header h2 { font-size: 10pt !important; margin-bottom: 2px !important; }
        .pdf-mode .header p { font-size: 8pt !important; margin-top: 2px !important; }
        .pdf-mode .form-group { margin-bottom: 7px !important; }
        .pdf-mode label { font-size: 7.5pt !important; margin-bottom: 2px !important; font-weight: 600; }
        .pdf-mode .row { gap: 8px !important; }
        .pdf-mode .date-tally { gap: 8px !important; margin-bottom: 10px !important; }
        .pdf-mode .declaration { padding: 8px !important; margin-bottom: 10px !important; }
        .pdf-mode .declaration h3 { font-size: 8.5pt !important; margin-bottom: 5px !important; }
        .pdf-mode .declaration p { font-size: 7pt !important; margin-bottom: 5px !important; }
        .pdf-mode .declaration ol { margin-left: 14px !important; font-size: 7pt !important; line-height: 1.2; }
        .pdf-mode .declaration li { margin-bottom: 2px !important; }
        .pdf-mode .signature-section { margin-top: 10px !important; padding-top: 8px !important; }
        .pdf-mode .signature-row { gap: 8px !important; margin-top: 8px !important; }
        .pdf-mode .note { font-size: 6.5pt !important; }
        .pdf-mode textarea { min-height: 40px !important; }
        .pdf-mode .checkbox-group { gap: 8px !important; margin-top: 4px !important; }
        .pdf-mode .checkbox-group label { font-size: 7pt !important; }

        @media print {
            body { background: white; padding: 0; font-size: 10pt; margin: 0; }
            .container { box-shadow: none; padding: 8mm; max-width: none; width: 100%; margin: 0; }
            .submit-btn, .post-submit-actions, .status-msg { display: none; }
            .row { grid-template-columns: 1fr 1fr; }
            input, textarea { border: 0.5px solid #000 !important; background: white; font-size: 8pt; padding: 4px; }
            .section { page-break-inside: avoid; margin-bottom: 10px; }
            .form-group { margin-bottom: 7px; }
            label { font-size: 7.5pt; margin-bottom: 2px; }
            .declaration { padding: 8px; }
            .declaration h3 { font-size: 8.5pt; margin-bottom: 5px; }
            .declaration p { font-size: 7pt; margin-bottom: 5px; }
            .declaration ol { margin-left: 14px; font-size: 7pt; line-height: 1.2; }
            .declaration li { margin-bottom: 2px; }
            .header h1 { font-size: 14pt; margin-bottom: 3px; }
            .header h2 { font-size: 10pt; margin-bottom: 2px; }
            .header p { font-size: 8pt; margin-top: 2px; }
            textarea { min-height: 40px; }
            @page { size: A4; margin: 8mm; }
        }

        @media (max-width: 768px) {
            .container { padding: 20px; }
            .row, .date-tally { grid-template-columns: 1fr; }
            .header h1 { font-size: 22px; }
            .header h2 { font-size: 16px; }
            .section-title { font-size: 15px; }
            .checkbox-group { gap: 10px; }
        }

        @keyframes progress {
            0% { width: 0%; }
            50% { width: 70%; }
            100% { width: 100%; }
        }
    </style>
</head>
<body>
    <div class="pdf-overlay" id="pdfOverlay"></div>
    <div class="pdf-generating" id="pdfGenerating">
        <h3>üìÑ PDF ‡§¨‡§®‡§æ‡§à ‡§ú‡§æ ‡§∞‡§π‡•Ä ‡§π‡•à...</h3>
        <p>‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡•á‡§Ç</p>
        <div style="margin-top: 20px;">
            <div style="width: 200px; height: 4px; background: #ddd; border-radius: 2px; overflow: hidden;">
                <div style="width: 0%; height: 100%; background: #4caf50; animation: progress 2s ease-in-out infinite;"></div>
            </div>
        </div>
    </div>

    <div class="container" id="formContainer">
        <div class="header">
            <h1>‡§ó‡•Ä‡§§‡§æ ‡§™‡•ç‡§∞‡•á‡§∏ ‡§ó‡•ã‡§∞‡§ñ‡§™‡•Å‡§∞</h1>
            <h2>‡§¶‡•Å‡§ï‡§æ‡§®‡§¶‡§æ‡§∞/‡§ñ‡•Å‡§¶‡§∞‡§æ ‡§µ‡§ø‡§ï‡•ç‡§∞‡•á‡§§‡§æ ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§´‡•â‡§∞‡•ç‡§Æ</h2>
            <p>‡§ó‡•Ä‡§§‡§æ ‡§™‡•ç‡§∞‡•á‡§∏ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∂‡§®‡•ã‡§Ç ‡§ï‡•Ä ‡§¨‡§ø‡§ï‡•ç‡§∞‡•Ä ‡§π‡•á‡§§‡•Å</p>
        </div>

        <div class="date-tally">
            <div class="form-group">
                <label>‡§Ü‡§µ‡•á‡§¶‡§® ‡§¶‡§ø‡§®‡§æ‡§Ç‡§ï:</label>
                <input type="date" name="application_date" id="application_date" readonly style="background-color: #f0f0f0; cursor: not-allowed;">
            </div>
            <div class="form-group">
                <label>‡§ü‡•à‡§≤‡•Ä ‡§ï‡•ã‡§°: <span class="note">(‡§ï‡•á‡§µ‡§≤ ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§≤‡§Ø ‡§â‡§™‡§Ø‡•ã‡§ó ‡§π‡•á‡§§‡•Å)</span></label>
                <input type="text" name="tally_code" readonly style="background-color: #f0f0f0; cursor: not-allowed;">
            </div>
        </div>

        <div class="section">
            <div class="section-title">‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø ‡§ï‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä</div>

            <div class="form-group">
                <label>‡§¶‡•Å‡§ï‡§æ‡§®/‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø ‡§ï‡§æ ‡§®‡§æ‡§Æ:</label>
                <input type="text" name="shop_name" required>
            </div>

            <div class="form-group">
                <label>‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø ‡§ï‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞:</label>
                <div class="checkbox-group">
                    <label><input type="radio" name="business_type" value="proprietorship"> ‡§∏‡•ç‡§µ‡§æ‡§Æ‡§ø‡§§‡•ç‡§µ</label>
                    <label><input type="radio" name="business_type" value="partnership"> ‡§∏‡§æ‡§ù‡•á‡§¶‡§æ‡§∞‡•Ä</label>
                    <label><input type="radio" name="business_type" value="private_limited"> ‡§™‡•ç‡§∞‡§æ‡§á‡§µ‡•á‡§ü ‡§≤‡§ø‡§Æ‡§ø‡§ü‡•á‡§°</label>
                    <label><input type="radio" name="business_type" value="llp"> LLP</label>
                </div>
            </div>

            <div class="form-group">
                <label>‡§¶‡•Å‡§ï‡§æ‡§® ‡§ï‡§æ ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§™‡§§‡§æ:</label>
                <textarea name="shop_address" rows="2"></textarea>
            </div>

            <div class="form-group">
                <label>‡§™‡§ø‡§®‡§ï‡•ã‡§°:</label>
                <input type="text" name="pincode" id="pincode" maxlength="6" pattern="[0-9]{6}" placeholder="6 ‡§Ö‡§Ç‡§ï‡•ã‡§Ç ‡§ï‡§æ ‡§™‡§ø‡§®‡§ï‡•ã‡§° ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç">
                <div class="status-msg loading" id="pincodeLoading">üîÑ ‡§∏‡•ç‡§•‡§æ‡§® ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...</div>
                <div class="status-msg error" id="pincodeError">‡§Ö‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§™‡§ø‡§®‡§ï‡•ã‡§° ‡§Ø‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Ö‡§∏‡§Æ‡§∞‡•ç‡§•</div>
                <div class="status-msg success" id="pincodeSuccess">‚úì ‡§∏‡•ç‡§•‡§æ‡§® ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§≤‡•ã‡§° ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ</div>
            </div>

            <div class="row">
                <div class="form-group">
                    <label>‡§∂‡§π‡§∞:</label>
                    <input type="text" name="city" id="city" placeholder="‡§∂‡§π‡§∞ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç">
                </div>
                <div class="form-group">
                    <label>‡§∞‡§æ‡§ú‡•ç‡§Ø:</label>
                    <input type="text" name="state" id="state" placeholder="‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç">
                </div>
            </div>

            <div class="row">
                <div class="form-group">
                    <label>‡§™‡•à‡§® ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ:</label>
                    <input type="text" name="pan_business" placeholder="XXXXXXXXXX" maxlength="10">
                </div>
                <div class="form-group">
                    <label>‡§ú‡•Ä‡§è‡§∏‡§ü‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ (GSTIN):</label>
                    <input type="text" name="gstin" maxlength="15">
                </div>
            </div>

            <div class="form-group">
                <label>‡§ó‡•Ä‡§§‡§æ‡§™‡•ç‡§∞‡•á‡§∏ ‡§ï‡•Ä ‡§™‡•Å‡§∏‡•ç‡§§‡§ï ‡§ï‡§¨ ‡§∏‡•á ‡§¨‡•á‡§ö ‡§∞‡§π‡•á ‡§π‡•à:</label>
                <input type="text" name="establishment_year" placeholder="‡§â‡§¶‡§æ. 2010 ‡§Ø‡§æ ‡§¶‡§∏ ‡§µ‡§∞‡•ç‡§∑" maxlength="50">
            </div>

            <div class="form-group">
                <label>‡§∏‡•ç‡§µ‡§æ‡§Æ‡•Ä/‡§∏‡§æ‡§ù‡•á‡§¶‡§æ‡§∞/‡§®‡§ø‡§¶‡•á‡§∂‡§ï ‡§ï‡§æ ‡§®‡§æ‡§Æ:</label>
                <input type="text" name="full_name" required>
            </div>

            <div class="row">
                <div class="form-group">
                    <label>‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞:</label>
                    <input type="tel" name="mobile" placeholder="+91 XXXXXXXXXX">
                </div>
                <div class="form-group">
                    <label>‡§µ‡•ç‡§π‡§æ‡§ü‡•ç‡§∏‡§è‡§™ ‡§®‡§Ç‡§¨‡§∞:</label>
                    <input type="tel" name="whatsapp" placeholder="+91 XXXXXXXXXX">
                </div>
            </div>

            <div class="form-group">
                <label>‡§à‡§Æ‡•á‡§≤ ‡§™‡§§‡§æ:</label>
                <input type="email" name="email" placeholder="example@email.com">
            </div>

            <div class="form-group">
                <label>‡§ï‡•Å‡§≤ ‡§¶‡•Å‡§ï‡§æ‡§® ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡§´‡§≤ (‡§µ‡§∞‡•ç‡§ó ‡§´‡•Å‡§ü):</label>
                <input type="number" name="shop_area" placeholder="‡§â‡§¶‡§æ. 500">
            </div>

            <div class="form-group">
                <label>‡§¶‡•Å‡§ï‡§æ‡§® ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£/‡§≤‡§æ‡§á‡§∏‡•á‡§Ç‡§∏ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ:</label>
                <input type="text" name="shop_license" placeholder="‡§≤‡§æ‡§á‡§∏‡•á‡§Ç‡§∏ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ">
            </div>
        </div>

        <div class="declaration">
            <h3>‡§ò‡•ã‡§∑‡§£‡§æ ‡§è‡§µ‡§Ç ‡§∂‡§∞‡•ç‡§§‡•á‡§Ç</h3>
            <p><strong>‡§Æ‡•à‡§Ç ‡§è‡§§‡§¶‡•ç‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§ò‡•ã‡§∑‡§£‡§æ ‡§ï‡§∞‡§§‡§æ/‡§ï‡§∞‡§§‡•Ä ‡§π‡•Ç‡§Å ‡§ï‡§ø:</strong></p>
            <ol>
                <li>‡§ä‡§™‡§∞ ‡§¶‡•Ä ‡§ó‡§à ‡§∏‡§≠‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§Æ‡•á‡§∞‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞ ‡§∏‡§§‡•ç‡§Ø ‡§è‡§µ‡§Ç ‡§∏‡§π‡•Ä ‡§π‡•à</li>
                <li>‡§Æ‡•à‡§Ç ‡§ó‡•Ä‡§§‡§æ ‡§™‡•ç‡§∞‡•á‡§∏ ‡§ï‡•á ‡§™‡•ç‡§∞‡§ï‡§æ‡§∂‡§®‡•ã‡§Ç ‡§ï‡•ã ‡§Ö‡§ß‡§ø‡§ï‡§§‡§Æ ‡§ñ‡•Å‡§¶‡§∞‡§æ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø (MRP) ‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï ‡§™‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§¨‡•á‡§ö‡•Ç‡§Å‡§ó‡§æ</li>
                <li>‡§Æ‡•à‡§Ç ‡§Ö‡§™‡§®‡•Ä ‡§¶‡•Å‡§ï‡§æ‡§® ‡§Æ‡•á‡§Ç ‡§ó‡•Ä‡§§‡§æ ‡§™‡•ç‡§∞‡•á‡§∏ ‡§ï‡•Ä ‡§™‡•Å‡§∏‡•ç‡§§‡§ï‡•ã‡§Ç ‡§ï‡§æ ‡§â‡§ö‡§ø‡§§ ‡§∏‡•ç‡§ü‡•â‡§ï ‡§è‡§µ‡§Ç ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§® ‡§¨‡§®‡§æ‡§è ‡§∞‡§ñ‡•Ç‡§Å‡§ó‡§æ</li>
                <li>‡§Æ‡•à‡§Ç ‡§ó‡•Ä‡§§‡§æ ‡§™‡•ç‡§∞‡•á‡§∏ ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡•Å‡§ù‡§æ‡§à ‡§ó‡§à ‡§™‡•ç‡§∞‡§ö‡§æ‡§∞ ‡§ó‡§§‡§ø‡§µ‡§ø‡§ß‡§ø‡§Ø‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§≠‡§æ‡§ó ‡§≤‡•Ç‡§Å‡§ó‡§æ</li>
                <li>‡§Æ‡•à‡§Ç ‡§∏‡§Æ‡§Ø-‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§ó‡•Ä‡§§‡§æ ‡§™‡•ç‡§∞‡•á‡§∏ ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§®‡§ø‡§∞‡•ç‡§ß‡§æ‡§∞‡§ø‡§§ ‡§∏‡§≠‡•Ä ‡§®‡§ø‡§Ø‡§Æ‡•ã‡§Ç / ‡§°‡§ø‡§∏‡•ç‡§ï‡§æ‡§â‡§Ç‡§ü ‡§è‡§µ‡§Ç ‡§¨‡•ã‡§®‡§∏ ‡§∂‡§∞‡•ç‡§§‡•ã‡§Ç ‡§ï‡§æ ‡§™‡§æ‡§≤‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§π‡§Æ‡§§ ‡§π‡•Ç‡§Å</li>
            </ol>
        </div>

        <div class="signature-section">
            <div class="signature-row">
                <div class="form-group">
                    <label>‡§¶‡§ø‡§®‡§æ‡§Ç‡§ï:</label>
                    <input type="date" name="declaration_date" id="declaration_date" readonly style="background-color: #f0f0f0; cursor: not-allowed;">
                </div>
            </div>
        </div>

        <div class="submit-status" id="submitStatus"></div>

        <div class="post-submit-actions" id="postSubmitActions">
            <h3>‚úì ‡§´‡•â‡§∞‡•ç‡§Æ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§ú‡§Æ‡§æ ‡§π‡•ã ‡§ó‡§Ø‡§æ!</h3>
            <p>‡§®‡•Ä‡§ö‡•á ‡§¶‡§ø‡§è ‡§ó‡§è ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™‡•ã‡§Ç ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç:</p>
            <button onclick="downloadPDF()">üìÑ ‡§´‡•â‡§∞‡•ç‡§Æ ‡§ï‡•ã PDF ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç</button>
            <button class="whatsapp-btn" onclick="shareOnWhatsApp()">üì± ‡§µ‡•ç‡§π‡§æ‡§ü‡•ç‡§∏‡§è‡§™ ‡§™‡§∞ ‡§≠‡•á‡§ú‡•á‡§Ç</button>
        </div>

        <button type="submit" class="submit-btn" id="submitBtn" onclick="handleSubmit(event)">‡§´‡•â‡§∞‡•ç‡§Æ ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç</button>
    </div>

    <script>
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxZCn12QwqRBNqIojzopfBMNVLV2vq8zaIA01V4ONYxWpIQMk9YuyyQlEW3HCpK1H8J/exec';

        window.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('application_date').value = today;
            document.getElementById('declaration_date').value = today;
            autoFillFromURL();
        });

        const fieldMapping = {
            'full_name': 'full_name', 'name': 'full_name', 'mobile': 'mobile', 'whatsapp': 'whatsapp', 
            'email': 'email', 'shop_name': 'shop_name', 'business_name': 'shop_name', 
            'business_type': 'business_type', 'shop_address': 'shop_address', 'address': 'shop_address', 
            'pincode': 'pincode', 'pin': 'pincode', 'city': 'city', 'state': 'state', 
            'pan_business': 'pan_business', 'gstin': 'gstin', 'gst': 'gstin', 
            'establishment_year': 'establishment_year', 'year': 'establishment_year', 
            'shop_area': 'shop_area', 'area': 'shop_area', 'shop_license': 'shop_license', 
            'license': 'shop_license', 'tally_code': 'tally_code'
        };

        function autoFillFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            let prefilledCount = 0;

            urlParams.forEach((value, key) => {
                const fieldId = fieldMapping[key.toLowerCase()];

                if (fieldId) {
                    const field = document.querySelector(`[name="${fieldId}"]`);

                    if (field) {
                        if (field.type === 'radio') {
                            const radioBtn = document.querySelector(`input[name="${fieldId}"][value="${value.toLowerCase()}"]`);
                            if (radioBtn) {
                                radioBtn.checked = true;
                                prefilledCount++;
                            }
                        } else if (field.type === 'checkbox') {
                            field.checked = value.toLowerCase() === 'true' || value === '1';
                            prefilledCount++;
                        } else {
                            field.value = value;
                            prefilledCount++;

                            if (fieldId === 'pincode' && value.length === 6) {
                                fetchPincodeDetails(value);
                            }
                        }

                        if (field.type !== 'date' && !field.hasAttribute('readonly')) {
                            field.style.backgroundColor = '#e8f5e9';
                            field.style.borderColor = '#4caf50';
                        }
                    }
                }
            });

            if (prefilledCount > 0) {
                console.log(`‚úì ${prefilledCount} fields pre-filled from URL parameters`);

                const notification = document.createElement('div');
                notification.style.cssText = 'position: fixed; top: 20px; right: 20px; background: #4caf50; color: white; padding: 15px 20px; border-radius: 5px; box-shadow: 0 4px 8px rgba(0,0,0,0.2); z-index: 1000; font-size: 14px;';
                notification.textContent = `‚úì ${prefilledCount} ‡§´‡§º‡•Ä‡§≤‡•ç‡§° URL ‡§∏‡•á ‡§≠‡§∞‡•Ä ‡§ó‡§à`;
                document.body.appendChild(notification);

                setTimeout(() => notification.remove(), 3000);
            }
        }

        const pincodeInput = document.getElementById('pincode');
        const cityInput = document.getElementById('city');
        const stateInput = document.getElementById('state');
        const loadingMsg = document.getElementById('pincodeLoading');
        const errorMsg = document.getElementById('pincodeError');
        const successMsg = document.getElementById('pincodeSuccess');
        let debounceTimer;

        pincodeInput.addEventListener('input', function() {
            const pincode = this.value.trim();

            loadingMsg.style.display = 'none';
            errorMsg.style.display = 'none';
            successMsg.style.display = 'none';
            cityInput.value = '';
            stateInput.value = '';

            clearTimeout(debounceTimer);

            if (pincode.length === 6 && /^\d{6}$/.test(pincode)) {
                loadingMsg.style.display = 'block';
                debounceTimer = setTimeout(() => fetchPincodeDetails(pincode), 500);
            }
        });

        async function fetchPincodeDetails(pincode) {
            try {
                const response = await fetch(`https://api.postalpincode.in/pincode/${pincode}`);

                if (!response.ok) throw new Error('API request failed');

                const data = await response.json();
                loadingMsg.style.display = 'none';

                if (data && data[0] && data[0].Status === 'Success' && data[0].PostOffice && data[0].PostOffice.length > 0) {
                    const postOffice = data[0].PostOffice[0];

                    cityInput.value = postOffice.District || postOffice.Block || '';
                    stateInput.value = postOffice.State || '';
                    successMsg.style.display = 'block';

                    setTimeout(() => successMsg.style.display = 'none', 3000);
                } else {
                    errorMsg.textContent = '‡§™‡§ø‡§®‡§ï‡•ã‡§° ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§∂‡§π‡§∞ ‡§î‡§∞ ‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§Æ‡•à‡§®‡•ç‡§Ø‡•Å‡§Ö‡§≤ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç';
                    errorMsg.style.display = 'block';
                }
            } catch (error) {
                console.error('Error fetching pincode details:', error);
                loadingMsg.style.display = 'none';

                errorMsg.textContent = '‡§ï‡•É‡§™‡§Ø‡§æ ‡§∂‡§π‡§∞ ‡§î‡§∞ ‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§Æ‡•à‡§®‡•ç‡§Ø‡•Å‡§Ö‡§≤ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç';
                errorMsg.style.display = 'block';

                setTimeout(() => errorMsg.style.display = 'none', 5000);
            }
        }

        async function handleSubmit(event) {
            event.preventDefault();

            const requiredFields = ['full_name', 'shop_name'];
            const submitBtn = document.getElementById('submitBtn');
            const statusDiv = document.getElementById('submitStatus');

            statusDiv.style.display = 'none';
            statusDiv.className = 'submit-status';

            for (let fieldName of requiredFields) {
                const field = document.querySelector(`[name="${fieldName}"]`);
                if (!field.value.trim()) {
                    field.style.borderColor = '#d93025';
                    alert(`${field.previousElementSibling.textContent.trim() || fieldName} ‡§Ö‡§®‡§ø‡§µ‡§æ‡§∞‡•ç‡§Ø ‡§π‡•à!`);
                    return;
                }
            }

            if (!document.querySelector('input[name="business_type"]:checked')) {
                alert('‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø ‡§ï‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç!');
                return;
            }

            const formData = new FormData();

            document.querySelectorAll('input[type="text"], input[type="email"], input[type="tel"], input[type="date"], input[type="number"], textarea').forEach(field => {
                formData.append(field.name, field.value || '');
            });

            ['business_type'].forEach(name => {
                const checked = document.querySelector(`input[name="${name}"]:checked`);
                formData.append(name, checked ? checked.value : '');
            });

            submitBtn.disabled = true;
            submitBtn.textContent = '‡§ú‡§Æ‡§æ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...';

            statusDiv.innerHTML = '<div class="loading">üì§ ‡§°‡•á‡§ü‡§æ ‡§Ö‡§™‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div>';
            statusDiv.style.display = 'block';

            try {
                const response = await fetch(APPS_SCRIPT_URL, {
                    method: 'POST',
                    body: formData
                });

                const result = await response.text();

                if (response.ok && result.includes('Success')) {
                    statusDiv.innerHTML = '<div class="success">‚úì ‡§´‡•â‡§∞‡•ç‡§Æ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§ú‡§Æ‡§æ ‡§π‡•ã ‡§ó‡§Ø‡§æ!</div>';
                    document.getElementById('postSubmitActions').style.display = 'block';
                } else {
                    throw new Error(result || '‡§Ö‡§ú‡•ç‡§û‡§æ‡§§ ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø');
                }
            } catch (error) {
                console.error('Submission error:', error);
                statusDiv.innerHTML = `<div class="error">‚ùå ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ${error.message}. ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§</div>`;
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = '‡§´‡•â‡§∞‡•ç‡§Æ ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç';
            }
        }

        function downloadPDF() {
            const overlay = document.getElementById('pdfOverlay');
            const loader = document.getElementById('pdfGenerating');
            
            overlay.classList.add('show');
            loader.classList.add('show');
            
            const element = document.getElementById('formContainer');
            
            // Add PDF mode class
            element.classList.add('pdf-mode');
            
            // Hide buttons and status messages temporarily
            const hiddenElements = [];
            document.querySelectorAll('.submit-btn, .post-submit-actions, .submit-status, .status-msg').forEach(el => {
                if (el.style.display !== 'none') {
                    hiddenElements.push(el);
                    el.style.display = 'none';
                }
            });
            
            const opt = {
                margin: [8, 8, 8, 8],
                filename: 'Gita_Press_Vikreta_Panjikaran_Form.pdf',
                image: { type: 'jpeg', quality: 0.95 },
                html2canvas: { 
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    letterRendering: true,
                    allowTaint: true,
                    scrollY: 0,
                    scrollX: 0,
                    backgroundColor: '#ffffff',
                    removeContainer: false,
                    imageTimeout: 0
                },
                jsPDF: { 
                    unit: 'mm', 
                    format: 'a4', 
                    orientation: 'portrait',
                    compress: true
                },
                pagebreak: { 
                    mode: ['avoid-all', 'css', 'legacy'],
                    avoid: ['.header', '.declaration', '.signature-section']
                }
            };
            
            html2pdf().set(opt).from(element).save().then(() => {
                // Restore visibility
                hiddenElements.forEach(el => {
                    el.style.display = '';
                });
                
                element.classList.remove('pdf-mode');
                
                setTimeout(() => {
                    overlay.classList.remove('show');
                    loader.classList.remove('show');
                }, 500);
            }).catch(err => {
                console.error('PDF generation error:', err);
                alert('PDF ‡§¨‡§®‡§æ‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§π‡•Å‡§à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§');
                
                // Restore visibility even on error
                hiddenElements.forEach(el => {
                    el.style.display = '';
                });
                
                element.classList.remove('pdf-mode');
                overlay.classList.remove('show');
                loader.classList.remove('show');
            });
        }

        function shareOnWhatsApp() {
            const formData = {
                shop_name: document.querySelector('[name="shop_name"]').value,
                full_name: document.querySelector('[name="full_name"]').value,
                mobile: document.querySelector('[name="mobile"]').value,
                city: document.querySelector('[name="city"]').value
            };

            const message = `‡§ó‡•Ä‡§§‡§æ ‡§™‡•ç‡§∞‡•á‡§∏ ‡§µ‡§ø‡§ï‡•ç‡§∞‡•á‡§§‡§æ ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§´‡•â‡§∞‡•ç‡§Æ ‡§ú‡§Æ‡§æ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ\n\n‡§¶‡•Å‡§ï‡§æ‡§® ‡§ï‡§æ ‡§®‡§æ‡§Æ: ${formData.shop_name}\n‡§®‡§æ‡§Æ: ${formData.full_name}\n‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤: ${formData.mobile}\n‡§∂‡§π‡§∞: ${formData.city}`;

            const whatsappURL = `https://wa.me/?text=${encodeURIComponent(message)}`;
            window.open(whatsappURL, '_blank');
        }
    </script>
</body>
</html>
